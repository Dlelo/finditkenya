extends ../layout

block content
  #home.parallax-content-list.baner-content-listing-biz
    .container-fluid.container-margin-top.container-fluidpadding
      section.the-products
        .row
          if cart
            #cart.row.alert-danger
              i.fa.fa-shopping-basket
              |  Items  #{cart.length}
          each product in products
            .col-md-3.item(id=product.slug,class="productid")
              h4
                =product.name
              img.item-image(src='/uploads/product/thumbs/'+product.photo)
              p
                =product.description
              .alert.alert-info
                | KES #{product.price}  
                button.btn.btn-warning.addtocart(id=product.slug)
                  | Add to Cart
  script(type='text/javascript').
    $(function(){
      var count = 0;
      if(#{cartexists}){
        count = #{cart.length};
      }
      //alert("cart count: "+count );
      $(document).on('click', '.addtocart', function(event) {
        console.log(event.target.id);
        $.ajax({
            type: "GET",
            url: "/product/api/"+event.target.id,
            success: function(res){
              //console.log(res);
              
              cart.push(res);
            }
        });
      });
    })
